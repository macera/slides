<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Kunibiki.rb#8</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section data-markdown
           data-separator="\n---\n$"
           data-vertical="\n--\n">
           <script type="text/template">
# Kunibiki.rb#8

LT & ãƒãƒ³ã‚ºã‚ªãƒ³

---

## Rails+GraphQL+Reactã§ç°¡å˜ãªã‚¢ãƒ—ãƒªã‚’ä½œã‚‹

---

### ãŠã—ãªãŒã

1. ç§ãŒGraphQLã‚’ä½¿ã„å§‹ã‚ãŸãƒ¯ã‚±
2. GraphQLã¨ã¯
3. GraphQLã®ç”¨èªè§£èª¬
4. ä»Šå›ã®ã‚¢ãƒ—ãƒªã®æ§‹æˆ
5. ãƒãƒ³ã‚ºã‚ªãƒ³: ç°¡å˜ãªTODOã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦ã¿ã‚‹

---

## 1. ç§ãŒGraphQLã‚’ä½¿ã„å§‹ã‚ãŸãƒ¯ã‚±

---

### ç™ºè¡¨è€…ã®æƒ…å ±

* æ™®æ®µã¯Railsãƒ»JQueryã§é–‹ç™ºã—ã¦ã„ã‚‹ã“ã¨ãŒå¤šã„ã€‚
* Railsã§APIã¯ä½•åº¦ã‹ä½œã£ãŸã“ã¨ã¯ã‚ã‚‹ã€‚
* ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰åˆå¿ƒè€…(Reactã¯ã¡ã‚‡ã£ã¨ã‚ã‹ã‚‹ã€‚Reduxã¯ã‚ã‹ã‚‰ã‚“)
* Reactã‚’ä½¿ã£ãŸã‚¤ã‚±ã¦ã‚‹ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªé–‹ç™ºã‚’ã—ãŸã„ã¨æ€ã£ã¦ã„ã‚‹ã€‚

---

Reactã‚’ä½¿ã£ãŸã‚¤ã‚±ã¦ã‚‹ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªé–‹ç™ºã‚’ã—ãŸã„ã¨æ€ã£ã¦ã„ã‚‹â˜ºï¸

ã—ã‹ã—ãã‚Œã«ã¯å¼Šå®³ãŒ...

---

## å¼Šå®³ğŸ˜­

* â‘  ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰(API)ã‚’ä½œã‚‰ãªã„ã¨ã„ã‘ãªã„
* â‘¡ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ç¹‹ãã“ã¿ãŒé›£ã—ã„
* â‘¢ æœªã ã«ã‚ˆãã‚ã‹ã‚‰ã‚“Redux...

---

## ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’ã‚„ã‚ŠãŸã„ã«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’ã‚„ã‚‰ã­ã°ãªã‚‰ã¬ã‚¸ãƒ¬ãƒ³ãƒğŸ˜­

---

## ãªã‹ãªã‹ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã‚¹ã‚¿ãƒ¼ãƒˆåœ°ç‚¹ã«ç«‹ã¦ãªã„!!!
## (ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã«é›†ä¸­ã—ãŸã„ğŸ”¥)

---

## ãã“ã§ç¾ã‚ŒãŸã®ãŒGraphQLã¨ãã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹ğŸ˜Š

---

* â‘  ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰(API)ã‚’ä½œã‚‰ãªã„ã¨ã„ã‘ãªã„(ã‚ã‚“ã©ã„)

=> GraphQLã‚’ä½¿ãˆã°ç°¡å˜ã«ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰(API)ã‚¢ãƒ—ãƒªãŒä½œã‚‰ã‚Œã‚‹!ğŸ˜†

---

* â‘¡ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ç¹‹ãã“ã¿ãŒé›£ã—ã„

=> apollo-client(GraphQLã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒª)ã‚’ä½¿ãˆã°ã€ç°¡å˜ã«ç¹‹ãã“ã¿ãŒè¡Œãˆã‚‹!ğŸ˜†

---

* â‘¢ æœªã ã«ã‚ˆãã‚ã‹ã‚‰ã‚“Redux...

=> ç°¡å˜ãªã‚¢ãƒ—ãƒªã§ã‚ã‚Œã°Reduxã‚’ä½¿ã†å¿…è¦ãŒãªã„(ã¨ã„ã†ã‹hookã®ç™»å ´ã§ã„ã‚‰ãªããªã‚‹ã¨ã„ã†å™‚)ğŸ˜†

---

è©³ã—ãã¯ã¯æœ€å¾Œã®ãƒãƒ³ã‚ºã‚ªãƒ³ã«ã¦ğŸ˜‰

---

### 2. GraphQLã¨ã¯

---

A query language for your API

APIã®ãŸã‚ã®å•ã„åˆã‚ã›è¨€èª

---

### 3ã¤ã®ç‰¹å¾´

1. Ask for what you need get exactly that
2. Get many resorces in a single request
3. Decribe what's possible with a type system

---

### 1. Ask for what you need get exactly that

å¿…è¦ãªè¦æ±‚ã ã‘å¿œç­”ã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã‚‹

ã‚¯ã‚¨ãƒªä¾‹:

Request
```
query {
	monster {
    name
    type
  }
}

```
monsterã¯ä»–ã«ã‚‚powerã‚„hpãªã©ã‚‚ã‚‚ã£ã¦ã„ã‚‹

Response
```
{
	"data": {
    "monster": {
      "name": "ã‚¹ãƒ©ã‚¤ãƒ ",
      "type": "ã‚¹ãƒ©ã‚¤ãƒ å±"
    }
  }
}
```

---

### 2. Get many resorces in a single request

é–¢é€£ã™ã‚‹æƒ…å ±ã‚‚ä¸€ã¤ã®Requestã§å¾—ã‚‹ã“ã¨ãŒã§ãã‚‹

Request
```
query {
	monster {
    name
    actions {
      name
    }
  }
}

```

Response
```
{
	"data": {
    "monster": {
      "name": "ãƒ›ã‚¤ãƒŸã‚¹ãƒ©ã‚¤ãƒ ",
      "actions": [
        { "name": "ãƒ›ã‚¤ãƒŸ" },
        { "name": "ã“ã†ã’ã" },
        { "name": "ã«ã’ã‚‹" }
      ]
    }
  }
}
```

---

### 3. Decribe what's possible with a type system

å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã¯å¿…ãšãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒ‡å®šã—ã¦è¦æ±‚ã™ã‚‹ã€‚
ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯å¿…ãšå‹ãŒæ±ºã¾ã£ã¦ã„ã‚‹ã€‚

---

### ã‚ˆãRESTã¨æ¯”è¼ƒã•ã‚Œã‚‹

### REST
* ãƒªã‚½ãƒ¼ã‚¹ã”ã¨ã«URL(ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ)ã‚’å®šç¾©ã™ã‚‹ã€‚
* è¿”ã£ã¦ãã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ±ºã¾ã£ã¦ã„ã‚‹(ä¸å¿…è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¾ã§è¿”ã£ã¦ãã‚‹)ã€‚

### GraphQL
* ãƒªã‚½ãƒ¼ã‚¹ã”ã¨ã«ã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©ã™ã‚‹ã€‚
* ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€ã¤ã€‚ãƒ¡ã‚½ãƒƒãƒ‰ã¯POSTã®ã¿ã€‚
* è¿”ã£ã¦ãã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§æŸ”è»Ÿã«å¤‰ãˆã‚‰ã‚Œã‚‹ã€‚

---

## ã¨ã‚Šã‚ãˆãšè§¦ã£ã¦ã¿ã‚‹ãªã‚‰

GraphiQL.app(GraphQLã®å®Ÿè¡Œç’°å¢ƒã‚¢ãƒ—ãƒª)

GithubAPI

https://developer.github.com/v4/explorer/

---

## GraphQLã®ç”¨èªè§£èª¬

```
* ã‚¹ã‚­ãƒ¼ãƒ(Shemas)
* ã‚¯ã‚¨ãƒª(Query)
* ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰(Field)
* å‹(Types)
* åˆ¥å(Aliases)
* ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆ(Fragments)
* æ“ä½œå(Operation Name)
* å¤‰æ•°(Variables)
* ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³(Mutation)
* ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆ(Inline Fragments)
* å‹å(__typename)
```

---

### ã‚¹ã‚­ãƒ¼ãƒ(Shemas)ã€ã‚¯ã‚¨ãƒª(Query)ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰(Field) ã€å‹(Types)

GithubAPI

maceraã¨ã„ã†ãƒ¦ãƒ¼ã‚¶ã®loginã¨nameã¨avatarUrlã‚’å–å¾—ã™ã‚‹ã‚¯ã‚¨ãƒª

```
query {
	user (login: "macera"){
    login
    name
    avatarUrl
  }
}

ã‚¹ã‚­ãƒ¼ãƒ => APIã®å®šç¾©ã€‚å¿…ãšä½•ã‹ã®å‹ã‚’å®šç¾©ã—ãªã„ã¨ã„ã‘ãªã„

user => å–å¾—ã—ãŸã„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€‚Userå‹(ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹)

loginã€name => å–å¾—ã—ãŸã„ã‚µãƒ–ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€‚Stringå‹(ã‚¹ã‚«ãƒ©ãƒ¼å‹)

(login: 'macera') => å¼•æ•°(Arguments)

```

---

maceraã¨ã„ã†ãƒ¦ãƒ¼ã‚¶ã®loginã¨nameã¨ã€
maceraãŒownerã®backend_todo_appãƒªãƒã‚¸ãƒˆãƒªã®description
ã‚’å–å¾—ã™ã‚‹ã‚¯ã‚¨ãƒª

```
query {
  repository (owner: "macera", name: "backend_todo_app"){
    description
  }
	user (login: "macera"){
    login
    name
  }
}
```

---

### åˆ¥å(Aliases)

ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹

```
query {
  user (login: "macera"){
    login
    name
  }
	user (login: "test_user"){
    login
    name
  }
}
```
---

### åˆ¥å(Aliases)

åˆ¥åã‚’ä½¿ã†ã¨OK

```
query {
  user1: user (login: "macera"){
    login
    name
  }
	user2: user (login: "test_user"){
    login
    name
  }
}
```

---

### ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆ(Fragments)

```
query {
  user1: user (login: "macera"){
    ...userFields
  }
	user2: user (login: "test_user"){
    ...userFields
  }
}

fragment userFields on User {
	login
	name
}
```

javascriptã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æ¼”ç®—å­(...)ã¿ãŸã„ãªã®ã§ã€ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆã‚’å±•é–‹ã™ã‚‹

---

### æ“ä½œå(Operation Name)

* æ“ä½œåãŒãªã„å ´åˆã€ã€Œqueryã€ã‚’çœç•¥ã§ãã‚‹
* ç„¡åã®æ“ä½œåã¯1ã¤ã—ã‹å®šç¾©ã§ããªã„(ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªåå‰ã‚’ã¤ã‘ã‚‹)

ã‚¨ãƒ©ãƒ¼

```
query {
	user (login: "macera"){
    login
    name
  }
}
query {
	user (login: "test_user"){
    login
    name
  }
}

```

---

### æ“ä½œå(Operation Name)

OK

```
query getUser1 {
	user (login: "macera"){
    login
    name
  }
}
query getUser2 {
	user (login: "test_user"){
    login
    name
  }
}

```

---

### å¤‰æ•°(Variables)

ã‚ˆãä½¿ã†!!!

Query Variables
```
{
	"login": "macera"
}

```

```
query ($login: String!){
	user (login: $login){
    login
    name
  }
}
```

---

### ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³(Mutation)

ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ãƒ»å‰Šé™¤ã™ã‚‹

QueryãŒREADã¨ã™ã‚‹ãªã‚‰

Mutationã¯ã€CREATEã€UPDATEã€DELETEã«å½“ãŸã‚‹

---

### ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³(Mutation)

backend_todo_appãƒªãƒã‚¸ãƒˆãƒªã®ã‚¹ã‚¿ãƒ¼ã‚’è¿½åŠ ã™ã‚‹

```
mutation addStar {
	addStar (input: {starrableId: "MDEwOlJlcG9zaXRvcnkxNzIzMzIwMTk="}){
    starrable{
      id
      viewerHasStarred
    }
  }
}
```
---

### ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆ(Inline Fragments)

slimeã¨ã„ã†åå‰ãŒã¤ãUserã¨Organizationã‚’è¿”ã™

```
query {
  search (query: "slime", type: USER, first: 100) {
    nodes {
      __typename
      ... on User {
        name
        url
      }
      ... on Organization {
        name
        url
      }
    }
  }
}
```

---

### å‹å(__typename)

è¿”ã•ã‚ŒãŸå‹ã®åç§°ã‚’è¿”ã™

```
{
  user(login: "macera") {
    login
    name
    __typename
  }
}

```

"User"ãŒè¿”ã£ã¦ãã‚‹

---

### ã„ã‚ã‚“ãªå‹

Graphiqlã®Docã§é»„è‰²è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã¯å…¨éƒ¨å‹

* ã‚¹ã‚«ãƒ©ãƒ¼å‹(Scalar Types)

  GraphQLã«ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ã•ã‚Œã¦ã„ã‚‹ã€ã“ã‚Œä»¥ä¸Šåˆ†è§£ã§ããªã„æœ€å°å˜ä½

  Stringã€IDã€URIã€Intãªã©

* ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹(Object Types)

  é–‹ç™ºè€…ãŒå®šç¾©ã™ã‚‹

  ã‚¹ã‚«ãƒ©ãƒ¼å‹ã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‹ãªã©ã‚’çµ„ã¿åˆã‚ã›ãŸã‚‚ã®

  GitHubAPIã§ã¯Userã‚„Repositoryãªã©

ä»–ã«ã‚‚ã‚ã‚‹

---

4. ä»Šå›ã®ã‚¢ãƒ—ãƒªã®æ§‹æˆ

---

## å®Ÿæ¼”ğŸ˜ƒ

---

### ãƒ•ãƒ­ãƒ³ãƒˆ

React + apollo-client(GraphQLã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¢ãƒ—ãƒª)

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

GraphQL + RubyonRails + SQLite

---

### 5. ãƒãƒ³ã‚ºã‚ªãƒ³: ç°¡å˜ãªTODOã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦ã¿ã‚‹

æ‰‹é †æ›¸

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

https://github.com/macera/backend_todo_app

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

https://github.com/macera/front-todo-app

---

å‚è€ƒã‚µã‚¤ãƒˆ

* ã€Œé›‘ã«å§‹ã‚ã‚‹ GraphQL Rubyã€class-based APIã€‘ã€

https://qiita.com/vsanna/items/031aa5a17a2f284eb65d

* ã€ŒAWS AppSyncã¨Reactã§ToDoã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦ã¿ã‚ˆã†(3) Reactã‚¢ãƒ—ãƒªã®ä½œæˆã€

https://qiita.com/daikiojm/items/da81259a3e365fee9333

* ã€ŒGraphQL with Reactå…¥é–€ - Queryã¨Mutationã‚’å­¦ã³Paginationã®å®Ÿè£…ã«ãƒãƒ£ãƒ¬ãƒ³ã‚¸ï¼ã€(æœ‰æ–™)

https://www.udemy.com/graphql-with-react/

* ã€Œapollo-boostã€

https://github.com/apollographql/apollo-client/tree/master/packages/apollo-boost

---

# ãŠã‚ã‚Š

ä»Šæ—¥ã®ã‚¹ãƒ©ã‚¤ãƒ‰:
https://macera.github.io/slides/docs/kunibikirb8/

           </script>
       </section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				transition: 'default',
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
    <style>
      body { text-transform: none; }
    </style>
	</body>
</html>
